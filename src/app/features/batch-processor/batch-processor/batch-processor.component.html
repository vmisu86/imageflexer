<div class="batch-processor-container">
    <div class="section-header">
        <h2>Batch Image Processor</h2>
        <p>Convert and resize multiple images in one go</p>
    </div>

    <nz-card>
        <div class="settings-panel">
            <form nz-form [nzLayout]="'vertical'">
                <div nz-row [nzGutter]="16">
                    <div nz-col [nzXs]="24" [nzSm]="12">
                        <div class="operation-group">
                            <div class="operation-header">
                                <h3>Format Conversion</h3>
                                <label nz-checkbox [(ngModel)]="convertEnabled"
                                    [ngModelOptions]="{standalone: true}"></label>
                            </div>

                            <nz-form-item>
                                <nz-form-label>Target Format</nz-form-label>
                                <nz-form-control>
                                    <nz-select [(ngModel)]="config.format" [nzDisabled]="!convertEnabled"
                                        [ngModelOptions]="{standalone: true}">
                                        <nz-option *ngFor="let option of formatOptions" [nzValue]="option.value"
                                            [nzLabel]="option.label">
                                        </nz-option>
                                    </nz-select>
                                </nz-form-control>
                            </nz-form-item>

                            <nz-form-item>
                                <nz-form-label>Quality</nz-form-label>
                                <nz-form-control>
                                    <nz-slider [(ngModel)]="config.quality" [nzMin]="1" [nzMax]="100"
                                        [ngModelOptions]="{standalone: true}"
                                        [nzDisabled]="!convertEnabled || config.format === 'image/png'">
                                    </nz-slider>
                                    <div *ngIf="config.format === 'image/png'" class="hint-text">
                                        PNG is a lossless format and doesn't use quality settings
                                    </div>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                    </div>

                    <div nz-col [nzXs]="24" [nzSm]="12">
                        <div class="operation-group">
                            <div class="operation-header">
                                <h3>Image Resizing</h3>
                                <label nz-checkbox [(ngModel)]="resizeEnabled"
                                    [ngModelOptions]="{standalone: true}"></label>
                            </div>

                            <div nz-row [nzGutter]="16">
                                <div nz-col [nzSpan]="12">
                                    <nz-form-item>
                                        <nz-form-label>Max Width (px)</nz-form-label>
                                        <nz-form-control>
                                            <nz-input-number [(ngModel)]="config.maxWidth" [nzMin]="1" [nzMax]="10000"
                                                [ngModelOptions]="{standalone: true}" [nzStep]="10"
                                                [nzDisabled]="!resizeEnabled">
                                            </nz-input-number>
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>

                                <div nz-col [nzSpan]="12">
                                    <nz-form-item>
                                        <nz-form-label>Max Height (px)</nz-form-label>
                                        <nz-form-control>
                                            <nz-input-number [(ngModel)]="config.maxHeight" [nzMin]="1" [nzMax]="10000"
                                                [ngModelOptions]="{standalone: true}" [nzStep]="10"
                                                [nzDisabled]="!resizeEnabled">
                                            </nz-input-number>
                                        </nz-form-control>
                                    </nz-form-item>
                                </div>
                            </div>

                            <nz-form-item>
                                <nz-form-control>
                                    <label nz-checkbox [(ngModel)]="config.preserveAspectRatio"
                                        [ngModelOptions]="{standalone: true}" [nzDisabled]="!resizeEnabled">
                                        Preserve aspect ratio
                                    </label>
                                </nz-form-control>
                            </nz-form-item>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <app-file-dropzone [isProcessing]="isProcessing" (process)="processImages($event)">
        </app-file-dropzone>
    </nz-card>

    <app-image-preview [images]="imageService.getProcessedImages()" [showComparison]="true"
        (download)="downloadImage($event)" (downloadAll)="downloadAll()" (clear)="clearResults()">
    </app-image-preview>
</div>